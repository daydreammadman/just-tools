# 浏览器指纹检测工具

展示浏览器能获取的客户端信息（仅限 Web API），帮助理解指纹追踪原理及隐私保护机制。

## ⚠️ 这不是硬件检测工具

**本工具展示的是"浏览器 API 能获取的信息"，而非真实硬件规格。**

这是一个**隐私教育工具**，用于展示 Web 开发者通过浏览器 API 能获取哪些客户端信息，以及这些信息的局限性。由于浏览器的隐私保护机制，很多硬件信息会被**模糊化、分级化或限制精度**。

**如果您需要查看真实硬件配置，请使用系统自带工具或专业软件（如 CPU-Z、鲁大师等）。**

### 数据精度说明

| 信息类型 | 精度说明 | 原因 |
|---------|---------|------|
| **操作系统** | ⚠️ 可能不准确 | 基于 User-Agent，可被伪造；Chrome 正在推行 UA Reduction（简化） |
| **屏幕分辨率** | ⚠️ 逻辑像素 | 显示的是 CSS 像素，受系统缩放影响；物理分辨率是估算值 |
| **CPU 核心数** | ⚠️ 逻辑线程数 | 超线程会翻倍（如 4核8线程显示为 8 核）；部分浏览器会限制最大值 |
| **内存** | ⚠️ 粗略分级 | 只能返回 0.25/0.5/1/2/4/8 GB，即使有 32GB 也只显示 8GB |
| **GPU** | ✅ 较准确 | 通过 WebGL 获取，通常能显示真实型号（如 NVIDIA GeForce RTX 3060） |
| **电池** | ⚠️ 逐渐废弃 | Firefox 已删除此 API；Chrome 正在降低精度（隐私保护） |

这些限制是浏览器为了**防止指纹追踪**和**保护用户隐私**而设计的。

## 功能模块

### 📡 网络信息（需要后端支持）
- **公网 IP 地址**：通过服务器获取客户端的真实 IP
- **地理位置**：IP 归属地（国家、省份、城市）
- **ISP 运营商**：网络服务提供商信息
- **HTTP Request Headers**：浏览器发送的完整请求头

### 💻 硬件信息（Web API 限制版）
- **操作系统**：OS 名称和版本（基于 UA，可能不准确）
- **屏幕分辨率**：逻辑像素和物理像素估算
- **设备像素比 (DPR)**：高清屏检测
- **CPU 核心数**：逻辑线程数（非物理核心）
- **设备内存估算**：粗略分级（0.25/0.5/1/2/4/8 GB）
- **GPU 信息**：通过 WebGL 获取真实显卡型号（较准确）
- **电池状态**：电量、充电状态、剩余时间（部分浏览器支持）

### 🌐 浏览器环境
- **浏览器识别**：自动解析浏览器名称和版本
- **渲染引擎**：浏览器引擎信息
- **User Agent**：原始 UA 字符串
- **语言偏好**：系统语言和语言列表
- **功能支持检测**：
  - 触控支持
  - Cookies 启用
  - LocalStorage
  - SessionStorage
  - Do Not Track

### 💾 存储检查
- **Cookie**：数量、大小、键名列表
- **LocalStorage**：存储项统计和占用空间
- **SessionStorage**：会话存储分析

## 隐私保护与教育意义

### 为什么信息会不准确？

浏览器厂商（Google、Mozilla、Apple）正在逐步限制 JavaScript 能获取的硬件信息，以对抗**浏览器指纹追踪**：

1. **User-Agent 简化**（UA Reduction）
   - Chrome 计划将 UA 统一为通用字符串
   - 例如：Windows 11 可能被报告为 "Windows 10"

2. **内存分级保护**
   - 真实内存映射到固定分级值
   - 防止通过精确内存值识别用户

3. **电池 API 废弃**
   - 研究表明电池信息可用于高精度指纹识别
   - Firefox 已完全移除，Chrome 正在限制

4. **硬件并发限制**
   - Safari 等浏览器会限制 `hardwareConcurrency` 最大值
   - 防止通过 CPU 核心数进行追踪

### 本工具的价值

本工具**不是硬件检测工具**（像 CPU-Z、鲁大师），而是：

✅ **隐私教育**：展示浏览器 API 能获取哪些客户端信息
✅ **开发参考**：了解 Web API 的能力和限制
✅ **指纹意识**：理解浏览器指纹追踪的原理
✅ **隐私对比**：查看不同浏览器的隐私保护策略差异

**如需查看真实硬件配置，请使用：**
- Windows: 任务管理器、系统信息 (msinfo32)、CPU-Z
- macOS: 关于本机、活动监视器
- Linux: lscpu、free -h、lspci

## 使用方法

### 1. 启动后端服务

```bash
# 安装后端依赖
cd backend
pip install -r requirements.txt

# 启动 FastAPI 服务
python main.py
```

后端服务将在 `http://localhost:8000` 运行。

### 2. 启动前端开发服务

```bash
# 在项目根目录
npm run dev
```

前端将在 `http://localhost:5173` 运行，Vite 已配置代理，会自动转发 `/api/*` 请求到后端。

### 3. 访问工具

在浏览器中访问 Just Tools，然后导航到"开发运维"分类，选择"浏览器指纹检测"工具。

## 主要用途

1. **隐私教育**：了解浏览器会暴露哪些信息
2. **开发调试**：查看不同浏览器的 API 差异
3. **指纹研究**：理解浏览器指纹识别的原理
4. **安全测试**：检查隐私保护插件的效果

## 功能按钮

- **刷新**：重新采集所有浏览器信息
- **复制全部 JSON**：导出完整数据（可用于指纹分析研究）

## 技术实现

### 前端技术
- **ua-parser-js**：解析 User Agent 字符串
- **Navigator API**：获取浏览器和硬件信息
- **WebGL API**：获取 GPU 真实型号（通过 `WEBGL_debug_renderer_info` 扩展）
- **Battery API**：电池状态检测（部分浏览器支持）
- **Storage API**：检查本地存储使用情况

### GPU 检测原理

```typescript
// 这是浏览器能获取到的最真实的硬件名称之一
const gl = canvas.getContext('webgl');
const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
// 返回类似 "NVIDIA GeForce RTX 3060" 的真实显卡型号
```

### 精度限制示例

```typescript
// CPU 核心数：逻辑线程数
navigator.hardwareConcurrency // 4核8线程返回 8

// 内存：粗略分级
navigator.deviceMemory // 32GB 内存只返回 8

// 屏幕分辨率：逻辑像素
screen.width // 4K 显示器 150% 缩放时可能返回 2560
```

### 分辨率计算精度问题 📐

这是一个经典的**浮点数精度丢失**案例：

**问题场景**：2560×1440 显示器 @ 150% 缩放

1. **真实逻辑宽度**：`2560 / 1.5 = 1706.666...`
2. **浏览器报告**：`1707`（四舍五入，**精度永久丢失**）
3. **反推物理宽度**：`1707 × 1.5 = 2560.5`
4. **最终显示**：`2561`（差 1 像素）

**为什么会这样？**

- `window.screen.width` 这个老旧 API 只返回整数
- 浏览器将 `1706.666...` 取整为 `1707`（误差 +0.333）
- 反推时误差被放大：`0.333 × 1.5 = 0.5 → 四舍五入 = 1`

**本工具的智能修正**：

- 检测到原始值为 `2560.5` 时，自动修正为 `2560`
- 显示为：`2560 (修正自 2560.5)`
- 教育用户理解"次像素"和"精度丢失"的概念

这个"差 1 像素"反而证明了工具真实地反映了浏览器与底层硬件之间的"代沟"！

### 后端技术
- **FastAPI**：提供网络信息 API
- **httpx**：异步 HTTP 客户端，获取 IP 地理位置
- **ip-api.com**：免费 IP 地理定位服务

### API 端点

#### `GET /api/system-info`

返回客户端网络信息：

```json
{
  "ip": "123.45.67.89",
  "location": "中国 广东 深圳",
  "isp": "中国电信",
  "headers": {
    "user-agent": "Mozilla/5.0...",
    "accept-language": "zh-CN,zh;q=0.9",
    ...
  }
}
```

#### `GET /api/health`

健康检查端点，返回服务状态。

## 安全说明

1. **敏感 Headers 过滤**：后端会自动过滤 Cookie、Authorization 等敏感信息
2. **CORS 配置**：仅允许本地开发环境访问
3. **数据不存储**：所有数据仅在内存中处理，不持久化
4. **客户端优先**：大部分信息直接在浏览器获取，减少服务端依赖

## 浏览器兼容性

- ✅ Chrome / Edge (推荐)
- ✅ Firefox
- ✅ Safari
- ⚠️ Battery API 支持有限（主要在 Chrome）

## 常见问题

### 为什么显示的硬件信息不准确？

这是正常的！本工具**不是硬件检测工具**，展示的是浏览器 API 受隐私保护限制后的数据：
- **内存**：只能返回固定分级值，无法获取真实大小
- **CPU**：返回逻辑线程数，而非物理核心数
- **分辨率**：返回 CSS 逻辑像素，受系统缩放影响

**如需查看真实硬件，请使用系统自带工具（任务管理器、关于本机等）或专业软件（CPU-Z、鲁大师）。**

### 网络信息显示"无法获取"

- 检查后端服务是否启动
- 确认 Vite 代理配置正确
- 查看浏览器控制台是否有 CORS 错误

### 电池信息不显示

这是正常的，Battery API 支持有限：
- Chrome/Edge：支持
- Firefox/Safari：不支持或需特殊权限

### IP 地址不准确

IP 地理位置基于第三方服务 (ip-api.com)，可能存在误差，尤其是使用代理或 VPN 的情况。

### 本工具能用来检测我的真实硬件配置吗？

**不能。** 本工具只展示浏览器 API 能获取的信息，这些信息受隐私保护限制，无法反映真实硬件。

如需查看真实配置：
- **Windows**: 按 `Win + Pause` 查看系统信息，或使用 CPU-Z
- **macOS**: 点击左上角  → 关于本机
- **Linux**: 终端运行 `lscpu`、`free -h`、`lspci`

## 开发说明

工具文件结构：
```
src/tools/system-inspector/
├── index.tsx       # 主组件
├── config.ts       # 工具配置
├── utils.ts        # 工具函数
└── types.ts        # 类型定义
```

## License

MIT
